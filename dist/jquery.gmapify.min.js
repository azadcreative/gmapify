/*
 *  jquery-gmapify - v
 *  Integrate Google Maps with multiple markers with Schema.Org data provided in markup.
 *  http://www.saddamazad.com
 *
 *  Made by Saddam Azad
 *  Under MIT License
 */
!function(a,b,c,d){"use strict";a.gmapify=function(b,c){var d={canvas:"",datasource:"",dataitems:"li",zoom:14,scrollwheel:!1},e=this;e.settings={},e.data={};a(b);e.init=function(){e.settings=a.extend({},d,c);var b=a(this.settings.datasource).find(this.settings.dataitems),f=[],g=[];a(b).each(function(){var b=a(this).find("a span.name").html(),c=a(this).find('.location span[property="latitude"]').attr("content"),d=a(this).find('.location span[property="longitude"]').attr("content"),e=a(this).find('a span[itemprop="streetAddress"]').html(),h=a(this).find('a span[itemprop="description"]').html();"undefined"==typeof h&&(h=""),g.push(['<div class="info_content"><h3>'+b+"</h3><h4>"+e+"</h4><p>"+h+"</p></div>"]),f.push([b,c,d])});for(var h=new google.maps.LatLngBounds,i=0;i<f.length;i++)h.extend(new google.maps.LatLng(f[i][1],f[i][2]));var j={center:h.getCenter(),zoom:e.settings.zoom,scrollwheel:e.settings.scrollwheel,mapTypeId:google.maps.MapTypeId.ROADMAP},k=new google.maps.Map(a(e.settings.canvas)[0],j);k.setTilt(45),k.fitBounds(h);var l,m=new google.maps.InfoWindow;for(google.maps.event.addListener(k,"click",function(){m.close()}),i=0;i<f.length;i++){var n=f[i],o=g[i][0],p=parseFloat(n[1]),q=parseFloat(n[2]),r=new google.maps.LatLng(p,q);l=new google.maps.Marker({position:r,map:k,content:o}),l.addListener("click",function(){m.setContent(this.content),m.open(k,this)})}a(b).find("a").on("click",function(){a(b).each(function(){a(this).find("a").removeClass("active")}),a(this).addClass("active"),i=a(this).parent().index();var c=f[i],d=g[i][0],e=parseFloat(c[1]),h=parseFloat(c[2]),j=new google.maps.LatLng(e,h);l=new google.maps.Marker({map:k,content:d,position:j}),google.maps.event.addListener(l,"click",function(){m.setContent(this.content),m.open(k,this)}),google.maps.event.trigger(l,"click")}),google.maps.event.addListenerOnce(k,"idle",function(){i=0;var a=f[i],b=g[i][0],c=parseFloat(a[1]),d=parseFloat(a[2]),e=new google.maps.LatLng(c,d);l=new google.maps.Marker({map:k,content:b,position:e}),google.maps.event.addListener(l,"click",function(){m.setContent(b),m.open(k,this)}),google.maps.event.trigger(l,"click")});var s=google.maps.event.addListener(k,"bounds_changed",function(){this.setZoom(e.settings.zoom),google.maps.event.removeListener(s)})},a(c.canvas).length>0&&e.init()},a.fn.gmapify=function(b){return this.each(function(){if(d===a(this).data("gmapify")){var c=new a.gmapify(this,b);a(this).data("gmapify",c)}})}}(jQuery);